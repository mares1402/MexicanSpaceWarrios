<html>
  <head>
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <script>
      // Componente para animar la posición de un objeto
      AFRAME.registerComponent('move-animation', {
        schema: {
          // Una cadena de texto con las posiciones (puntos) por las que pasará el objeto, separadas por comas.
          path: {
            type: 'string',
            // Función para convertir el texto en un array de posiciones
            parse: function (value) {
              return value.split(',').map(posStr => posStr.trim());
            }
          },
          // Duración en milisegundos en cada posición
          dur: {type: 'number', default: 250}
        },

        init: function () {
          this.index = 0;
          this.lastTime = 0;
        },

        tick: function (time, timeDelta) {
          if (time - this.lastTime < this.data.dur) {
            return;
          }
          this.lastTime = time;

          // Cambiamos el atributo 'position' al siguiente punto en la ruta
          this.el.setAttribute('position', this.data.path[this.index]);

          // Avanzamos al siguiente punto y volvemos al inicio si llegamos al final
          this.index = (this.index + 1) % this.data.path.length;
        }
      });
    </script>
  </head>
  <body>
    <a-scene>
      <!-- 1. Solo necesitamos cargar el modelo una vez -->
      <a-assets>
        <a-asset-item id="miModelo" src="animaciones/low_poly_earth.glb"></a-asset-item>
      </a-assets>

      <!-- Añadimos luces para que el modelo sea visible -->
      <a-light type="ambient" color="#888"></a-light>
      <a-light type="directional" intensity="0.5" position="-1 1 0"></a-light>

      <a-sky color="#ECECEC"></a-sky>

      <!-- 2. Usamos el nuevo componente 'move-animation' -->
      <a-gltf-model 
        src="#miModelo"
        scale="0.5 0.5 0.5"
        move-animation="path: 0 1 -3, 1 1 -3, 0 2 -3; dur: 500">
      </a-gltf-model>
    </a-scene>
  </body>

</html>